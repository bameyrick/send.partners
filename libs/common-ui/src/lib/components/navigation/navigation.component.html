<header class="Navigation__header">
  <h1 class="Navigation__logo">Send Partners</h1>

  <button class="Navigation__burger" [icon]="Icon.MenuBurger" [iconOnly]="true" (click)="menuOpen = !menuOpen"></button>
</header>

<div class="Navigation__backdrop"></div>

<div class="Navigation__expandable">
  <nav class="Navigation__nav">
    <ul class="Navigation__list">
      <li *ngFor="let item of navigationGroups" class="Navigation__item">
        <ng-container *ngIf="!item.translationKey">
          <ng-container *ngTemplateOutlet="navigationLink; context: { $implicit: item.items[0] }"></ng-container>
        </ng-container>

        <ng-container *ngIf="item.translationKey">
          <details #details class="Navigation__group" open (toggle)="item.open = details.open">
            <summary
              class="Navigation__group-summary"
              [icon]="item.open ? Icon.CaretDown : Icon.CaretUp"
              [iconPlacement]="IconPlacement.After"
              [iconClass]="'Navigation__caret'"
            >
              <div *ngIf="!item.url" class="Navigation__group-title">
                <span [iconClass]="'Navigation__icon'" [icon]="item.icon" [ngStyle]="{ fill: item.iconColour }"> </span>
                {{ item.translationKey | translate }}
                <notification-count
                  class="Navigation__notification-count"
                  [count]="item.open ? 0 : (item.items | groupNotifications)"
                ></notification-count>
              </div>

              <ng-container *ngIf="item.url">
                <ng-container *ngTemplateOutlet="navigationLink; context: { $implicit: item }"> </ng-container>
              </ng-container>
            </summary>

            <ul class="Navigation__list">
              <li *ngFor="let groupItem of item.items">
                <ng-container *ngTemplateOutlet="navigationLink; context: { $implicit: groupItem }"></ng-container>
              </li>
            </ul>
          </details>
        </ng-container>
      </li>
    </ul>
  </nav>

  <footer class="Navigation__footer">
    <div class="Navigation__account">
      <a [routerLink]="getRouterLinkForAppPath(AppPath.MyProfile)" (click)="menuOpen = false" class="Navigation__user">
        <avatar class="Navigation__avatar" [currentUser$]="currentUser$"></avatar> {{ (currentUser$ | async)?.name }}
      </a>
      <a class="Navigation__logout" (click)="logout()" (click)="menuOpen = false">{{ 'common.logout' | translate }}</a>
    </div>
  </footer>
</div>

<ng-template #navigationLink let-item>
  <a
    [routerLinkActive]="['Navigation__link--active']"
    [routerLink]="item.url"
    class="Navigation__link"
    [iconClass]="'Navigation__icon'"
    [icon]="item.icon"
    [ngStyle]="{ fill: item.iconColour }"
    (click)="menuOpen = false"
  >
    {{ item.translationKey | translate }}

    <notification-count class="Navigation__notification-count" [count]="item.notificationCount"></notification-count>
  </a>
</ng-template>
